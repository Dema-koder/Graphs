Данные задачи решаются также как задача 1317. Удаление клеток. В подобных задачах проще и лучше использовать dfs
